---
// src/components/BlogArticleShowcase.astro

// Defines the data structure for a single article item.
export interface Article {
  href: string; // URL for the article.
  badge: string; // Category badge (e.g., "Horizons", "The Edge").
  date: string; // Publication date.
  title: string; // Article title.
  readTime?: string; // Optional: Reading time (e.g., "1 minute read").
  imageUrl?: string; // Optional: Image URL for larger cards.
  imageAlt?: string; // Optional: Image alt text.
  isLarge?: boolean; // Optional: If true, renders as a larger card with an image.
}

// Defines the props accepted by the BlogArticleShowcase component.
export interface Props {
  title: string; // Main title for the section (e.g., "Explore news and thought leadership").
  titleHref: string; // URL for the main title link.
  articles: Article[]; // Array of article data to display.
}

const { title, titleHref, articles } = Astro.props;

// Separate the first article if it's marked as large, otherwise take the first article
// and treat the rest as smaller articles.
const largeArticle = articles.find(article => article.isLarge);
const otherArticles = articles.filter(article => !article.isLarge);

// If no article is explicitly marked as large, take the first one as large and the rest as others.
const firstArticle = largeArticle || articles[0];
const remainingArticles = largeArticle ? otherArticles : articles.slice(1);

---

<div id="latest-thinking">
    <div class="module news-grid-container js-news-grid-container latest-thinking-block bg-light-grey-1" id="copy">
        <div class="wrap">
            <div class="col small-12 text-center push--bottom">
                <h2 class="text-left tera push-half--bottom soft--bottom latest-thinking-block__title">
                    <a href={titleHref} class="core-branding-cobalt">
                        {title}
                    </a>
                </h2>
                <div class="js-filter-pills">
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="masonry">
                <div class="news-grid news-grid--vertical js-news-grid"
                    data-filters=""
                    data-news-layout="vertical"
                    data-news-endpoint="/api/v1/search/latest-thinking/8ed09efb-7598-44af-a859-95a2736ecd14"
                    data-news-extra-endpoint="/api/v1/search/latest-thinking/365640a0-e31b-44d6-9c28-8393c4c3c596"
                    data-pinned-endpoint=""
                    data-news-batchsize="4"
                    data-vertical-card-button-url="/horizons/"
                    data-vertical-card-button-text=""
                >
                    <div class="text-center soft--ends status js-filter__default hide">
                        <p class="font-regular">Loading...</p>
                    </div>
                    <div class="news-grid news-grid--vertical js-news-grid-wrapper">
                        {firstArticle && (
                            <a href={firstArticle.href} class="col small-12 large-4 push--bottom fade-in-up fade-in-up--1 tile-link card img-overlay">
                                {firstArticle.imageUrl && (
                                    <figure class="img-overlay__wrap ratio--5x29">
                                        <img class="img-overlay__image" src={firstArticle.imageUrl} alt={firstArticle.imageAlt || firstArticle.title}>
                                        <div class="img-overlay__effect"></div>
                                    </figure>
                                )}
                                <div class="card__block">
                                    <span class="badge push-half--bottom">{firstArticle.badge}</span>
                                    <div>
                                        <time class="beta italic inline">{firstArticle.date}</time>
                                        {firstArticle.readTime && <p class="read-time"><span>{firstArticle.readTime}</span></p>}
                                    </div>
                                    <h3 class="kilo font-600 tile-link__hover-blue">{firstArticle.title}</h3>
                                </div>
                            </a>
                        )}
                        <div class="news-grid__cards-wrapper js-layout-inner">
                            {remainingArticles.map((article, index) => (
                                <a href={article.href} class="col small-12 small-medium-6 large-6 push--bottom fade-in-up fade-in-up--1 tile-link card img-overlay">
                                    {article.imageUrl && ( // Although smaller cards in example don't have images, keeping this for flexibility
                                        <figure class="img-overlay__wrap ratio--5x29">
                                            <img class="img-overlay__image" src={article.imageUrl} alt={article.imageAlt || article.title}>
                                            <div class="img-overlay__effect"></div>
                                        </figure>
                                    )}
                                    <div class="card__block">
                                        <span class="badge push-half--bottom">{article.badge}</span>
                                        <div>
                                            <time class="beta italic inline">{article.date}</time>
                                            {article.readTime && <p class="read-time"><span>{article.readTime}</span></p>}
                                        </div>
                                        <h3 class="kilo font-600 tile-link__hover-blue">{article.title}</h3>
                                    </div>
                                </a>
                            ))}
                        </div>
                    </div>
                </div>
            </div>
            <div class="js-filter__more"></div>
        </div>
    </div>
</div>